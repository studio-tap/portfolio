# 開発ログ

## 2025-07-27

### プロジェクトセットアップとVercelへのデプロイ
Dockerを使用してNext.jsの開発環境を構築した。`docker-compose.yml`と`Dockerfile`を適切に設定し、コンテナ内で`create-next-app`を実行。これにより、Next.jsの初期プロジェクトが作成され、Welcomeページが無事に表示された。

その後、Next.jsの開発元であるVercelについて学習。Vercelが提供するサーバーレスのホスティングプラットフォームの利点（Next.jsへの最適化、パフォーマンス、優れた開発体験など）を、従来のレンタルサーバーと比較しながら理解を深めた。

学習の一環として、作成したNext.jsプロジェクトをGitHubリポジトリ経由でVercelにデプロイし、正常に公開されていることを確認した。

### コンポーネント設計思想の確立
今後の開発方針として、Reactのコンポーネント設計について議論を開始した。

まず、UI設計手法であるAtomic Designについて検討。その概念は理解しつつも、化学由来の命名が直感的でない点や、各要素の粒度の区別が曖昧であるという課題が挙げられた。

そこで、これまでのWeb制作経験で培われたCSS設計（`base`, `layout`, `project`, `component`, `utility`）の考え方を応用し、より実践的で分かりやすい独自のコンポーネント設計ルールを模索することにした。

議論の結果、以下の様なディレクトリ構成と粒度のルールを仮説として立てた。これは、Atomic Designの思想の良い部分を取り入れつつ、命名の分かりにくさを解消することを目的としている。

#### コンポーネントのカテゴリ（`src/components`直下）
*   `/base`: グローバルなスタイルや基本的なHTML要素をラップするコンポーネント。
*   `/layout`: ヘッダーやフッターなど、ページの骨格を定義するコンポーネント。
*   `/ui`: 主要なUIを構成するコンポーネント群。粒度ごとのサブディレクトリを持つ。
*   `/feature`: 特定の機能に特化した、再利用性の低いコンポーネント。
*   `/utility`: 汎用的なヘルパーコンポーネント。

#### UIコンポーネントの粒度（`src/components/ui`配下）
*   **Atom（原子）**: `Button`, `Input`など、UIの最小単位。
*   **Module（モジュール）**: `SearchForm`など、複数のAtomを組み合わせた機能単位。
*   **Block（ブロック）**: `Header`など、ModuleやAtomを組み合わせたより複雑なセクション。

この設計思想を元に、今後の開発を進めていく方針を確認した。

## 2025-07-28

### 開発ログのルール確認
`DEVELOPMENT_LOG.md`に会話の記録を残すルールを再確認した。

### ディレクトリ構造の修正
`create-next-app`の実行によって意図せず生成された`src/app/src`という深い階層構造を修正。Next.jsプロジェクトのルートを`portfolio/src`に設定し直し、`docker-compose.yml`のパスも合わせて更新した。これにより、より標準的で管理しやすいディレクトリ構造になった。

### コンポーネント設計に関する再検討
ディレクトリ構造の議論から派生し、コンポーネント設計について再度検討を行った。Atomic DesignがUIのデザイン論であるのに対し、開発側の視点（再利用性、疎結合）をより重視した設計の必要性を確認。その中で、Feature-Based, Fractal-Based, Page-Basedなど、複数の有名なディレクトリ構造パターンについて学習し、それぞれの長所と短所を理解した。最終的に、Next.jsの標準的な構成である`src`をプロジェクトルートとすることに決定した。

### 動作確認とデプロイ設定
一連のディレクトリ構造の修正後、`docker-compose down`と`docker-compose up -d --build`を実行し、ローカル環境でNext.jsのWelcomeページが正常に表示されることを確認した。その後、変更内容を`git add .`でステージングし、「2025-07-28: ディレクトリ構造の全面的な見直しと正常化」というメッセージでコミット、リモートリポジトリへプッシュした。最後に、Vercelのプロジェクト設定において、Root Directoryを新しいプロジェクトルートである`src`に変更し、再デプロイを行うことで、本番環境にも変更を反映させた。

### コンポーネント設計の再々検討と方針転換
コンポーネント設計について再度議論を行った。ユーザーはAtomic Designに納得せず、汎用性、UI/ロジックの分離、明確な粒度を重視した独自の5段階ディレクトリ構造（`component`, `module`, `object`, `feature`, `page`）を提案した。

この提案に対し、私は各カテゴリの定義の厳密さ、特に「見た目だけ」のコンポーネントの維持の難しさや、`module`/`object`の役割の曖昧さ、過剰な抽象化による複雑性などの課題を指摘した。

議論の結果、ユーザーは「componentにロジックを含まない」ことの難しさや、自身の「非スタンドアロン」「スタンドアロン」の概念がReactのコンポーネント開発と完全にマッチしない可能性を認識した。

最終的に、概念的な議論を一旦中断し、実際にページを構築しながらReactでの最適な実装方法を探索する方針に転換することで合意した。

### Next.js App Routerの基本分析
Next.jsのWelcomeページがブラウザに表示されるまでのロジックとレンダリングの仕組みを分析した。`src/app/layout.tsx`がアプリケーション全体の骨格とメタデータを定義し、`src/app/page.tsx`がルートURLのコンテンツを定義していることを確認した。Next.jsがこれらをサーバーサイドでレンダリングし、HTMLとしてブラウザに送信するプロセスを理解した。

また、Next.js App Routerにおけるルーティングとレイアウトの概念について深く掘り下げた。具体的には、`layout.tsx`のネスト、`template.tsx`との違い、`page.tsx`の役割、フォルダ名によるルーティング定義、そしてグループルートによる共通レイアウトの適用方法について理解を深めた。

さらに、`layout.tsx`のインポートブロックについて詳細に分析し、`Metadata`が型定義であること、`Geist`や`Geist_Mono`がフォントローダー関数であることを確認した。Next.js App Routerでよく使われる型（`React.ReactNode`, `LayoutProps`など）についても理解を深めた。最後に、`Metadata`のような型と`Link`のようなランタイム値のインポートの違い、そして共通インポートをまとめるプラクティスについて議論した。
